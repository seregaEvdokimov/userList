<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <div id="app"></div>

    <!--app-->
<script src="js/app.js"></script>

    <!--lib-->
<script src="js/lib/Timer.js"></script>
<script src="js/lib/ProgressBarTimer.js"></script>
<script src="js/lib/Tooltip.js"></script>
<script src="js/lib/Validator.js"></script>
<script src="js/lib/imageUploader.js"></script>
<script src="js/lib/Event.js"></script>
<script src="js/lib/Dictionary.js"></script>

    <!--Requests-->
<script src="js/request/request.js"></script>
<script src="js/request/xhr.js"></script>

    <!--Model-->
<script src="js/model/model.js"></script>
<script src="js/model/user.js"></script>
<script src="js/model/tooltip.js"></script>

    <!--Views-->
<script src="js/view/view.js"></script>
<script src="js/view/templates/header/index.js"></script>
<script src="js/view/templates/header/search.js"></script>
<script src="js/view/templates/header/settings.js"></script>
<script src="js/view/templates/header/languages.js"></script>
<script src="js/view/templates/user/index.js"></script>
<script src="js/view/templates/user/table-head.js"></script>
<script src="js/view/templates/user/table-body.js"></script>
<script src="js/view/templates/user/table-bodyrow.js"></script>
<script src="js/view/templates/modal/index.js"></script>
<script src="js/view/templates/modal/modal-confirm.js"></script>
<script src="js/view/templates/modal/user-create.js"></script>
<script src="js/view/templates/modal/user-edit.js"></script>
<script src="js/view/templates/option/index.js"></script>
<script src="js/view/templates/option/new-user.js"></script>
<script src="js/view/templates/option/pagination.js"></script>
<script src="js/view/templates/notify/index.js"></script>
<script src="js/view/templates/notify/notify-item.js"></script>

    <!--init-->
<script src="js/init/init.js"></script>
<script src="../worker.js"></script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.6.0/socket.io.js"></script>-->
    <script>
        var worker = new SharedWorker('../worker.js');
        worker.port.addEventListener("message", function(e) {
            var data = JSON.parse(e.data);
            console.log('worker say: ' + data.type);
            switch (data.type) {
                case 'connect':
                    console.info('connect');
                    break;
                case 'new user':
                    App.serviceContainer.template.notify.create(data.payload, 'createUser');
                    App.serviceContainer.template.userTableTbody.createRow(data.payload);
                    break;
                case 'time passed':
                    data.payload.forEach(function(item) {
                        App.serviceContainer.template.notify.create(item, 'timePassed');
                    });
                    break;
            }
        }, false);

        worker.port.start();
//        worker.port.postMessage("connect");
    </script>
</body>
</html>