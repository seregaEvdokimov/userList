<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/app.js"></script>
</head>
<body>

    <div id="app"></div>

<script src="js/app.js"></script>
<script src="../worker.js"></script>

    <script>
        var worker = new SharedWorker('../worker.js');
        worker.port.addEventListener("message", function(e) {
            var data = JSON.parse(e.data);
            console.log('worker say: ' + data.type);
            switch (data.type) {
                case 'connect':
                    console.info('connect');
                    break;
                case 'new user':
                    App.serviceContainer.template.notify.create(data.payload, 'createUser');
                    App.serviceContainer.template.userTableTbody.createRow(data.payload);
                    break;
                case 'time passed':
                    data.payload.forEach(function(item) {
                        App.serviceContainer.template.notify.create(item, 'timePassed');
                    });
                    break;
            }
        }, false);

        worker.port.start();
//        worker.port.postMessage("connect");
    </script>
</body>
</html>