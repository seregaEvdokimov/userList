!function(t,e){"use strict";function i(i){var o=this;this.el=e.createElement("tbody"),this.el.className="tBody",this.el.dataset.languageKey="tBody",this.container=t.serviceContainer,this.dictionary=this.container.lib.dictionary,this.collection=i.collection,this.tableEl=i.tableEl,this.tRows=[],this.sortConfig={param:"id",direction:"asc"},this.event=t.Lib.Event,this.collection.user.forEach(function(e){var i=new t.View.UserTable.Body.Row({collection:e,tbodyEl:o});o.tRows.push(i)}),this.el.addEventListener("click",this.handlerCotrolsBtn.bind(this,this)),this.el.addEventListener("transitionend",this.transitionend.bind(this,this)),t.serviceContainer.template.userTableTbody=this}i.prototype.handlerCotrolsBtn=function(t,e){var i=e.target;if("A"!=i.tagName)return!1;var o=i.parentNode.parentNode.querySelector(".id").textContent;switch(i.className){case"edit-btn":t.container.template.modalEdit.show(o);break;case"delete-btn":t.tRows.forEach(function(t){t.id==o&&t.el.classList.add("deleting")})}},i.prototype.transitionend=function(t,e){var i=e.target,o=i.className;switch(o){case"deleting":t.removeRow(i)}},i.prototype.sort=function(t){var e=this.sortConfig,i=t.sort(function(t,i){var o="date"==e.param||"birth"==e.param?new Date(t[e.param]).getTime():t[e.param],n="date"==e.param||"birth"==e.param?new Date(i[e.param]).getTime():i[e.param],r=0;return r="asc"==e.direction?o>n?1:-1:o>n?-1:1});return i},i.prototype.search=function(t){var e=this.tRows.filter(function(e){var i=e.collection.name;return i.indexOf(t.find)!=-1});return e},i.prototype.removeRow=function(t){var e=this,i=this.container.model.user,o=t.querySelector(".id").textContent;e.tRows=e.tRows.reduce(function(t,e){return"deleting"!=e.el.className?t.push(e):e.destroy(),t},[]),i.delete(o).then(function(t){e.event.dispatch("deleteRow"),e.container.template.notify.create(t,"deleteUser")})},i.prototype.updateRow=function(t){this.tRows.forEach(function(e){e.id==t.id&&e.update(t)})},i.prototype.createRow=function(e){this.collection.user.push(e);var i=new t.View.UserTable.Body.Row({collection:e,tbodyEl:this});i.el.classList.add("addition"),this.tRows.push(i),this.el.insertBefore(i.init(),this.el.firstChild),setTimeout(function(){i.el.classList.remove("addition")},100),this.event.dispatch("addRow")},i.prototype.newRows=function(e){var i=this,o={};this.tRows.forEach(function(t){o[t.id]=!0}),e.forEach(function(e){if(!o.hasOwnProperty(e.id)){var n=new t.View.UserTable.Body.Row({collection:e,tbodyEl:i});i.tRows.push(n)}}),this.render()},i.prototype.clearRows=function(t){this.tRows=this.tRows.reduce(function(e,i){var o=t.filter(function(t){return t.id==i.id});return o.length?e.push(i):i.destroy(),e},[])},i.prototype.render=function(t){t&&"sort"==t.type&&(this.sortConfig=t),this.el.innerHTML="";var i=e.createDocumentFragment(),o=this.sort(this.tRows);return t&&"search"==t.type&&(o=this.search(t)),o.forEach(function(t){i.appendChild(t.init())}),this.el.appendChild(i),this.el},t.View.UserTable.Body=i}(App,document);